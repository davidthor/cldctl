---
title: "Routes"
description: "Configure subdomains, path prefixes, hostnames, and TLS for component routes"
---

# Routes

Configure subdomains, path prefixes, hostnames, and TLS certificates for component routes at the environment level.

## Basic Usage

```yaml
components:
  my-app:
    image: ghcr.io/org/my-app:v1.0.0
    routes:
      main:
        subdomain: custom-name     # optional, deterministic default
        pathPrefix: /api           # optional, defaults to "/"
```

## Properties

| Property | Type | Description |
|----------|------|-------------|
| `subdomain` | string | Route subdomain. Passed to datacenter hooks as `node.inputs.subdomain`. When omitted, a deterministic human-readable default is generated (e.g., `salty-aardvark`). Must be lowercase alphanumeric with hyphens, no leading/trailing hyphens. |
| `pathPrefix` | string | Route path prefix. Passed to datacenter hooks as `node.inputs.path_prefix`. Defaults to `"/"`. Must start with `/`. |
| `hostnames` | array | List of hostname configurations (advanced use) |
| `tls` | object | TLS/HTTPS configuration |

### Hostname Properties

| Property | Type | Description |
|----------|------|-------------|
| `subdomain` | string | Subdomain of environment domain |
| `host` | string | Explicit fully-qualified hostname |

### TLS Properties

| Property | Type | Description |
|----------|------|-------------|
| `enabled` | boolean | Enable HTTPS |
| `secretName` | string | Custom TLS secret name (optional) |

## Subdomain and Path Prefix

The `subdomain` and `pathPrefix` fields give environment operators control over how routes are exposed, ensuring deterministic URLs and preventing collisions between applications.

### Deterministic Defaults

When `subdomain` is not explicitly set, a deterministic human-readable default is generated using a hash of the environment name, component name, and route name. For example, deploying `my-app` to `staging` might generate `salty-aardvark` as the subdomain. The same inputs always produce the same name.

### Explicit Overrides

```yaml
components:
  my-app:
    image: ghcr.io/org/my-app:v1.0.0
    routes:
      main:
        subdomain: my-custom-name
        pathPrefix: /api
      admin:
        subdomain: admin-panel
```

### CLI Overrides

You can also set subdomain and pathPrefix from the CLI without modifying the environment file:

```bash
cldctl deploy component myapp:v1 -e staging \
  --route-subdomain main=my-custom-name \
  --route-path-prefix main=/api

cldctl up -c ./my-app -d local \
  --route-subdomain main=cool-prefix \
  --route-path-prefix api=/v2
```

### How It Works

The subdomain and pathPrefix values are passed through to datacenter hooks as `node.inputs.subdomain` and `node.inputs.path_prefix`. Datacenter authors use these values to configure DNS records, load balancer rules, or nginx proxy configurations.

## Hostname Configuration

### Subdomain-Based

Use the environment's base domain:

```yaml
routes:
  main:
    hostnames:
      - subdomain: app      # app.staging.example.com
      - subdomain: www      # www.staging.example.com
```

### Explicit Hostname

Specify the full hostname:

```yaml
routes:
  main:
    hostnames:
      - host: app.example.com
      - host: www.example.com
```

### Mixed Configuration

```yaml
routes:
  main:
    hostnames:
      - subdomain: app           # app.staging.example.com
      - host: app.example.com    # Explicit FQDN
```

## TLS Configuration

### Basic TLS

Enable automatic TLS certificate provisioning:

```yaml
routes:
  main:
    hostnames:
      - subdomain: app
    tls:
      enabled: true
```

### Custom TLS Secret

Use a pre-existing TLS certificate:

```yaml
routes:
  main:
    hostnames:
      - host: app.example.com
    tls:
      enabled: true
      secretName: production-tls-cert
```

## Multiple Routes

Configure different routes independently:

```yaml
components:
  my-app:
    image: ghcr.io/org/my-app:v1.0.0
    routes:
      main:
        hostnames:
          - subdomain: app
          - subdomain: www
        tls:
          enabled: true

      api:
        hostnames:
          - subdomain: api
        tls:
          enabled: true

      admin:
        hostnames:
          - subdomain: admin
        tls:
          enabled: true
```

## Environment Patterns

### Development

Simple subdomain without TLS:

```yaml
components:
  my-app:
    path: ./
    routes:
      main:
        hostnames:
          - subdomain: dev
```

### Staging

Subdomain with TLS:

```yaml
components:
  my-app:
    image: ghcr.io/org/my-app:v1.0.0
    routes:
      main:
        hostnames:
          - subdomain: staging
        tls:
          enabled: true
```

### Production

Custom domains with managed certificates:

```yaml
components:
  my-app:
    image: ghcr.io/org/my-app:v1.0.0
    routes:
      main:
        hostnames:
          - host: app.example.com
          - host: www.example.com
        tls:
          enabled: true
          secretName: production-tls
```

### Preview Environments

Dynamic subdomains for PRs:

```yaml
name: preview-${{ pr_number }}

components:
  my-app:
    image: ghcr.io/org/my-app:pr-${{ pr_number }}
    routes:
      main:
        hostnames:
          - subdomain: preview-${{ pr_number }}
        tls:
          enabled: true
```

## Complete Example

```yaml
name: staging
datacenter: aws-production

locals:
  base_domain: "staging.example.com"

components:
  auth-service:
    image: ghcr.io/myorg/auth:v2.1.0
    routes:
      public:
        hostnames:
          - subdomain: auth
        tls:
          enabled: true

  web-app:
    image: ghcr.io/myorg/web-app:v1.5.0
    routes:
      main:
        hostnames:
          - subdomain: www
          - subdomain: app
        tls:
          enabled: true
      
      api:
        hostnames:
          - subdomain: api
        tls:
          enabled: true

  admin-portal:
    image: ghcr.io/myorg/admin:v1.0.0
    routes:
      admin:
        hostnames:
          - subdomain: admin
        tls:
          enabled: true
```

## DNS Configuration

Routes create the following DNS requirements:

| Hostname Type | DNS Record |
|---------------|------------|
| `subdomain: app` | `app.staging.example.com` → Load Balancer |
| `host: app.example.com` | `app.example.com` → Load Balancer |

The datacenter's route hook typically handles DNS record creation automatically.
