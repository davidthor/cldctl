---
title: "Vercel Functions"
description: "Deploy serverless functions to Vercel with Neon databases"
---

# Vercel Functions Datacenter

This guide shows how to build a datacenter that deploys components to Vercel with Neon for PostgreSQL and Vercel Blob for storage.

<Info>
Example source: `examples/datacenters/vercel-functions/`
</Info>

## Overview

This datacenter provides:
- **Compute**: Vercel Serverless Functions
- **Frameworks**: Native Next.js, Nuxt, SvelteKit support
- **Databases**: Neon PostgreSQL, Upstash Redis
- **Storage**: Vercel Blob
- **Edge**: Vercel Edge Functions

## Why Vercel?

- **Framework optimized**: Native support for popular frameworks
- **Preview deployments**: Automatic previews for every PR
- **Edge network**: Global CDN with edge caching
- **Zero configuration**: Deploy without infrastructure setup

## Configuration Variables

```hcl
variable "vercel_token" {
  description = "Vercel API token"
  type        = string
  sensitive   = true
}

variable "vercel_team_id" {
  description = "Vercel team ID"
  type        = string
}

variable "neon_api_key" {
  description = "Neon API key for PostgreSQL"
  type        = string
  sensitive   = true
}

variable "upstash_api_key" {
  description = "Upstash API key for Redis"
  type        = string
  sensitive   = true
}

variable "domain" {
  description = "Base domain for environments"
  type        = string
}
```

## Environment Configuration

```hcl
environment {
  # Vercel project per environment
  module "vercel_project" {
    build = "./modules/vercel-project"
    inputs = {
      name    = environment.name
      team_id = variable.vercel_team_id
      token   = variable.vercel_token
    }
  }

  # DNS configuration
  module "dns_zone" {
    build = "./modules/cloudflare-dns"
    inputs = {
      zone      = variable.domain
      subdomain = environment.name
    }
  }
}
```

## Resource Hooks

### Database Hook (Neon)

```hcl
database {
  module "neon_database" {
    build = "./modules/neon-database"
    inputs = {
      name    = node.name
      type    = node.inputs.databaseType
      version = node.inputs.databaseVersion
      project = environment.name
      api_key = variable.neon_api_key
    }
  }

  outputs = {
    host     = module.neon_database.host
    port     = module.neon_database.port
    database = module.neon_database.database
    url      = module.neon_database.connection_url
  }
}
```

### Function Hook (Vercel Functions)

```hcl
function {
  module "vercel_function" {
    build = "./modules/vercel-function"
    inputs = {
      name        = node.name
      image       = node.inputs.image
      framework   = node.inputs.framework
      environment = node.inputs.environment
      memory      = node.inputs.memory
      timeout     = node.inputs.timeout
      project_id  = module.vercel_project.project_id
      token       = variable.vercel_token
    }
  }

  outputs = {
    id       = module.vercel_function.function_id
    endpoint = module.vercel_function.url
  }
}
```

### Bucket Hook (Vercel Blob)

```hcl
bucket {
  module "vercel_blob" {
    build = "./modules/vercel-blob"
    inputs = {
      name  = node.name
      token = variable.vercel_token
    }
  }

  outputs = {
    endpoint        = module.vercel_blob.endpoint
    bucket          = module.vercel_blob.store_id
    region          = module.vercel_blob.region
    accessKeyId     = module.vercel_blob.access_key
    secretAccessKey = module.vercel_blob.secret_key
  }
}
```

### Ingress Hook (Vercel Routes)

```hcl
ingress {
  module "vercel_route" {
    build = "./modules/vercel-route"
    inputs = {
      name       = node.name
      type       = node.inputs.type
      rules      = node.inputs.rules
      project_id = module.vercel_project.project_id
      domain     = "${environment.name}.${variable.domain}"
      token      = variable.vercel_token
    }
  }

  outputs = {
    url   = "https://${environment.name}.${variable.domain}"
    hosts = ["${environment.name}.${variable.domain}"]
  }
}
```

## Framework Support

Vercel automatically detects and optimizes for frameworks:

```yaml
# Component definition
functions:
  web:
    build:
      context: .
    framework: nextjs  # Vercel optimizes for Next.js
```

Supported frameworks:
- **Next.js**: Full SSR, ISR, App Router support
- **Nuxt**: Vue.js framework
- **SvelteKit**: Svelte framework
- **Remix**: React framework
- **Astro**: Static site generator

## Vercel Integration Benefits

### Automatic Preview Deployments

Each PR gets a preview URL:

```bash
# Triggered automatically on PR
https://preview-123-my-app.vercel.app
```

### Edge Functions

Deploy to the edge for low latency:

```yaml
functions:
  api:
    runtime: edge  # Deploy as Edge Function
```

### Environment Variables

Vercel manages environment variables securely:

```hcl
module "vercel_function" {
  inputs = {
    environment = node.inputs.environment
    # Vercel encrypts and injects at runtime
  }
}
```

## Deploying

```bash
# Build and deploy datacenter
arcctl dc build . -t ghcr.io/myorg/vercel-dc:v1.0.0
arcctl dc push ghcr.io/myorg/vercel-dc:v1.0.0

arcctl dc deploy vercel-prod \
  --config ghcr.io/myorg/vercel-dc:v1.0.0 \
  --var vercel_token=$VERCEL_TOKEN \
  --var vercel_team_id=$VERCEL_TEAM_ID \
  --var neon_api_key=$NEON_API_KEY \
  --var domain=app.example.com

# Deploy a Next.js app
arcctl env create staging --datacenter vercel-prod
arcctl deploy ghcr.io/myorg/my-nextjs-app:v1.0.0 -e staging
```

## Ideal Use Cases

- Next.js applications
- Jamstack sites
- Preview environments for PRs
- Frontend-focused teams
- Global audience (edge deployment)

## Limitations

- No traditional container deployments
- Limited to Vercel's runtime environments
- Cold start latency for serverless

## Related Guides

<CardGroup cols={2}>
  <Card title="Serverless Neon" href="/guides/datacenters/serverless-neon">
    Alternative serverless with Cloudflare
  </Card>
  <Card title="Next.js App" href="/guides/components/nextjs-app">
    Next.js component example
  </Card>
</CardGroup>
