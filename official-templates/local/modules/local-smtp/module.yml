# Native module for local SMTP server using MailHog
# MailHog captures all outgoing emails and provides a web UI for viewing
plugin: native
type: docker

inputs:
  name:
    type: string
    required: true
    description: SMTP server name
  network:
    type: string
    required: true
    description: Docker network to join

resources:
  container:
    type: docker:container
    properties:
      image: "mailhog/mailhog:latest"
      name: "${inputs.name}"
      network: "${inputs.network}"
      ports:
        # SMTP port
        - container: 1025
          host: 0
        # Web UI port
        - container: 8025
          host: 0
      restart: unless-stopped

outputs:
  host:
    value: "${inputs.name}"
    description: SMTP host (container name for Docker network access)
  port:
    value: "1025"
    description: SMTP port (internal container port)
  host_port:
    value: "${resources.container.ports[0].host}"
    description: SMTP port on host (for host-based access)
  username:
    value: ""
    description: SMTP username (none required for MailHog)
  password:
    value: ""
    sensitive: true
    description: SMTP password (none required for MailHog)
  web_url:
    value: "http://localhost:${resources.container.ports[1].host}"
    description: MailHog web UI URL for viewing captured emails
