# Native module for running one-time Docker containers (migrations, scripts, etc.)
plugin: native
type: docker

inputs:
  name:
    type: string
    required: true
    description: Container name
  image:
    type: string
    required: true
    description: Docker image to run
  command:
    type: list
    description: Command to execute
  network:
    type: string
    required: true
    description: Docker network to join
  environment:
    type: map
    default: {}
    description: Environment variables
  log_driver:
    type: string
    description: Docker logging driver (e.g., "fluentd", "json-file")
  log_driver_options:
    type: map
    default: {}
    description: Options for the Docker logging driver

resources:
  container:
    type: docker:container
    properties:
      image: "${inputs.image}"
      name: "${inputs.name}"
      network: "${inputs.network}"
      command: "${inputs.command}"
      environment: "${inputs.environment}"
      # Run once and exit - don't restart
      restart: "no"
      # Remove container after completion
      auto_remove: false
      # Wait for container to complete
      wait: true
      log_driver: "${inputs.log_driver}"
      log_options: "${inputs.log_driver_options}"

outputs:
  container_id:
    value: "${resources.container.container_id}"
    description: Docker container ID
